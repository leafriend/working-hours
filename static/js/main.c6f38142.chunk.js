(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,n){e.exports=n(22)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),i=n(7),l=n.n(i),c=(n(15),n(1)),s=(n(16),n(2)),u=n(4),d=n(5);function h(e){return e<10?"0".concat(e):e.toString()}!function(e){e.WORK="WORK",e.HALF="HALF",e.FULL="FULL"}(a||(a={}));var g=["2019-05-01","2019-05-06","2019-06-06"],f="logsSet";function v(e){return function(t,n){return null===t?function(e,t){var n="".concat(e,"-").concat(h(t));return{date:n,isHoliday:g.includes(n),leaveType:a.WORK}}(e,n+1):t}}var m=function(){function e(){var t=this;Object(u.a)(this,e),this.hash={};var n=localStorage.getItem(f);if(null===n)localStorage.setItem(f,"{}");else{var o=JSON.parse(n);Object.entries(o).forEach(function(e){var n=Object(c.a)(e,2),o=n[0],r=n[1];t.hash[o]=r.map(function(e,t){if(null===e){var n="".concat(o,"-").concat(h(t+1));return{date:n,isHoliday:g.includes(n),leaveType:a.WORK}}return Object(s.a)({},e,{isHoliday:g.includes(e.date)})})})}}return Object(d.a)(e,[{key:"getLogs",value:function(e){if(e in this.hash)return this.hash[e].map(v(e));var t=e.split("-").map(function(e){return parseInt(e)}),n=Object(c.a)(t,2),a=function(e,t){return new Date(e,t,0).getDate()}(n[0],n[1]),o=Array(a).fill(null).map(v(e));return this.setLogs(e,o),o}},{key:"setLogs",value:function(e,t){this.hash[e]=t.map(function(e){return{date:e.date,isHoliday:e.isHoliday,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}});var n={};Object.entries(this.hash).forEach(function(e){var t=Object(c.a)(e,2),a=t[0],o=t[1];n[a]=o.map(function(e){return{date:e.date,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}})}),localStorage.setItem(f,JSON.stringify(n))}}]),e}(),y=n(8),p=n.n(y);n(17);function E(e){return r.a.createElement("textarea",{className:"json-view",value:p()(e.logs).replace(/\t/g,"  "),onChange:function(t){return e.onLogsChange(JSON.parse(t.target.value))}})}n(18);function b(e){return r.a.createElement("footer",null,r.a.createElement("select",{value:e.viewMode,onChange:function(t){return e.handleViewModeChange(t.target.value)}},e.viewModes.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),r.a.createElement("a",{href:"https://github.com/leafriend/working-hours/",target:"_blank",rel:"noopener noreferrer"},"Github"))}n(19);function w(e){return r.a.createElement("header",null,"Working Hours of"," ",r.a.createElement("select",{value:e.yearMonth,onChange:function(t){return e.onYearMonthChange(t.target.value)}},e.yearMonths.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))}var A=n(3);n(20);function L(e){return void 0===e?void 0:function(e){var t="-"===e.charAt(0)?-1:1,n=(t<0?e.substring(1):e).split(":").map(function(e){return parseInt(e,10)}),a=Object(c.a)(n,2),o=a[0],r=a[1];return t*(60*o+r)}(e)}function O(e){return void 0===e?void 0:function(e){var t=e<0?"-":"",n=Math.abs(e),a=Math.floor(n/60),o=n-60*a;return"".concat(t).concat(h(a),":").concat(h(o))}(e)}var k=6,j=0,S=function(){function e(t,n,a){Object(u.a)(this,e),this.log=t,this.accumulation=n,this.isActive=a,this.isSaturday=void 0,this.isSunday=void 0;var o=new Date(t.date).getDay();this.isSunday=o===j,this.isSaturday=o===k}return Object(d.a)(e,[{key:"date",get:function(){return this.log.date}},{key:"isHoliday",get:function(){return this.log.isHoliday}},{key:"leaveType",get:function(){return this.log.leaveType}},{key:"startedAt",get:function(){return L(this.log.startedAt)}},{key:"finishedAt",get:function(){return L(this.log.finishedAt)}},{key:"working",get:function(){var e=this;if(this.leaveType===a.FULL)return 570;if(void 0!==this.startedAt&&void 0!==this.finishedAt){var t=this.finishedAt-this.startedAt;return function(){switch(e.leaveType){case a.HALF:return t>=240?480:240+t;case a.WORK:return t<270?t-0:t<540?t-30:t<810?t-60:t-90}}()}}},{key:"overtime",get:function(){if(void 0!==this.working)return this.working-480}},{key:"overall",get:function(){return void 0===this.working?this.accumulation.overall:this.accumulation.overall+this.working}},{key:"target",get:function(){return this.isHoliday||this.isSaturday||this.isSunday?this.accumulation.target:this.accumulation.target+480}},{key:"balance",get:function(){return void 0===this.overtime?this.accumulation.balance:this.accumulation.balance+this.overtime}}]),e}();n(21);function N(e){var t=e.calculatedLog,n=null===t||t.isHoliday||t.isSunday||t.isSaturday,o=null!==t&&t.leaveType===a.FULL;function i(t){if(null!==e.calculatedLog){var n=Object(s.a)({date:e.calculatedLog.date,isHoliday:e.calculatedLog.isHoliday,leaveType:e.calculatedLog.leaveType,startedAt:O(e.calculatedLog.startedAt),finishedAt:O(e.calculatedLog.finishedAt)},t);e.onLogChange(n)}}var l=t?t.date:"Select a date",c=t?t.leaveType:a.WORK,u=t&&O(t.startedAt)||"",d=t&&O(t.finishedAt)||"";return r.a.createElement("div",{className:"LogEditor"},r.a.createElement("h2",null,l),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Leave Type:",r.a.createElement("select",{disabled:n,value:c,onChange:function(e){return i({leaveType:e.target.value})}},r.a.createElement("option",{value:a.WORK},"Work"),r.a.createElement("option",{value:a.HALF},"Half"),r.a.createElement("option",{value:a.FULL},"Full"))),r.a.createElement("label",null,"Started:",r.a.createElement("input",{disabled:n,readOnly:!n&&o,type:"time",value:u,onChange:function(e){return i({startedAt:e.target.value||void 0})}})),r.a.createElement("label",null,"Finished:",r.a.createElement("input",{disabled:n,readOnly:!n&&(o||!t||void 0===t.startedAt),type:"time",value:d,onChange:function(e){return i({finishedAt:e.target.value||void 0})}}))))}function T(e){return r.a.createElement("tr",{className:[e.log.isHoliday?"holiday":e.log.isSunday?"sunday":e.log.isSaturday?"saturday":"",e.log.isActive?"active":""].join(" ").replace(/ +/g," ").trim(),onClick:function(){return e.onActivate(e.log.date)}},r.a.createElement("td",{className:"date"},new Date(e.log.date).getDate()),r.a.createElement("td",null,e.log.leaveType),r.a.createElement("td",{className:"time"},O(e.log.startedAt)||""),r.a.createElement("td",{className:"time"},O(e.log.finishedAt)||""),r.a.createElement("td",{className:"time"},O(e.log.working)||""),r.a.createElement("td",{className:"time"},O(e.log.overall)),r.a.createElement("td",{className:"time"},O(e.log.target)),r.a.createElement("td",{className:"time"},O(e.log.balance)))}function M(e){return r.a.createElement("table",{className:"monthly-logs"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"date"},"D."),r.a.createElement("th",null,"Leave"),r.a.createElement("th",{className:"time"},"Start"),r.a.createElement("th",{className:"time"},"Fin."),r.a.createElement("th",{className:"time"},"Work"),r.a.createElement("th",{className:"time"},"All"),r.a.createElement("th",{className:"time"},"Target"),r.a.createElement("th",{className:"time"},"Bal."))),r.a.createElement("tbody",null,e.logs.map(function(t){return r.a.createElement(T,{key:t.date,log:t,onActivate:e.onActivate})})))}var C=new Date,H="".concat(C.getFullYear(),"-").concat(h(C.getMonth()+1),"-").concat(h(C.getDate())),W={overall:0,target:0,balance:0};function F(e){var t=W,n=Array(e.length);return e.forEach(function(e,a){var o=new S(e,t,!1);n[a]=o,t=o}),n}function R(e){var t=e.yearMonthLog.yearMonth,n=Object(o.useState)(H.startsWith(t)?Object(A.a)({},t,H):{}),a=Object(c.a)(n,2),i=a[0],l=a[1],u=Object(o.useState)({}),d=Object(c.a)(u,2),h=d[0],g=d[1],f=Object(o.useState)(F(e.yearMonthLog.logs)),v=Object(c.a)(f,2),m=v[0],y=v[1];return Object(o.useEffect)(function(){var n=i[t],a=F(e.yearMonthLog.logs);a.forEach(function(e){return e.isActive=e.date===n}),y(a)},[t,e.yearMonthLog,i]),Object(o.useEffect)(function(){var e=document.getElementById("content-container");if(e)if(void 0===h[t]){console.log("scrollTop is undefined");var n=document.getElementsByClassName("active");console.log("els.length",n),n.length>0?e.scrollTo({top:n.item(0).offsetTop}):e.scrollTo({top:0})}else e.scrollTo({top:h[t]})},[t,m]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"content-container",onScroll:function(e){return n=e.target.scrollTop,void g(Object(s.a)({},h,Object(A.a)({},t,n)));var n}},r.a.createElement(M,{logs:m,onActivate:function(e){l(Object(s.a)({},i,Object(A.a)({},t,e)))}})),r.a.createElement("div",null,r.a.createElement(N,{calculatedLog:m.find(function(e){return e.isActive})||null,onLogChange:function(t){m.forEach(function(e){e.date===t.date&&(e.log=t)}),y(m);var n=m.map(function(e){return e.log});e.onLogsChange(n)}})))}var D="2019-05",U=["2019-05","2019-06"],I=R.name,K=E.name,B=new m;var J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(r.a.createElement(function(){var e=Object(o.useState)(D),t=Object(c.a)(e,2),n=t[0],a=t[1],i=Object(o.useState)(B.getLogs(n)),l=Object(c.a)(i,2),s=l[0],u=l[1],d=Object(o.useState)(I),h=Object(c.a)(d,2),g=h[0],f=h[1];function v(e){u(e),B.setLogs(D,e)}return r.a.createElement("div",{className:"App"},r.a.createElement(w,{yearMonth:n,yearMonths:U,onYearMonthChange:function(e){a(e),u(B.getLogs(e))}}),r.a.createElement("article",null,function(){switch(g){case I:return r.a.createElement(R,{yearMonthLog:{yearMonth:n,logs:s},onLogsChange:v});case K:return r.a.createElement(E,{logs:s,onLogsChange:v});default:return null}}()),r.a.createElement(b,{viewMode:g,viewModes:[I,K],handleViewModeChange:function(e){return f(e)}}))},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/working-hours",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/working-hours","/service-worker.js");J?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):x(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):x(t,e)})}}()}],[[9,1,2]]]);
//# sourceMappingURL=main.c6f38142.chunk.js.map