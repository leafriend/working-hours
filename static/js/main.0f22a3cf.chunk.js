(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,a){e.exports=a(22)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n,o=a(0),r=a.n(o),i=a(7),l=a.n(i),c=(a(15),a(1)),s=(a(16),a(2)),u=a(4),d=a(5);function g(e){return e<10?"0".concat(e):e.toString()}!function(e){e.WORK="WORK",e.HALF="HALF",e.FULL="FULL"}(n||(n={}));var h=["2019-05-01","2019-05-06","2019-06-06"],f="logsSet";function v(e){return function(t,a){return null===t?function(e,t){var a="".concat(e,"-").concat(g(t));return{date:a,isHoliday:h.includes(a),leaveType:n.WORK}}(e,a+1):t}}var m=function(){function e(){var t=this;Object(u.a)(this,e),this.hash={};var a=localStorage.getItem(f);if(null===a)localStorage.setItem(f,"{}");else{var o=JSON.parse(a);Object.entries(o).forEach(function(e){var a=Object(c.a)(e,2),o=a[0],r=a[1];t.hash[o]=r.map(function(e,t){if(null===e){var a="".concat(o,"-").concat(g(t+1));return{date:a,isHoliday:h.includes(a),leaveType:n.WORK}}return Object(s.a)({},e,{isHoliday:h.includes(e.date)})})})}}return Object(d.a)(e,[{key:"getLogs",value:function(e){if(e in this.hash)return this.hash[e].map(v(e));var t=e.split("-").map(function(e){return parseInt(e)}),a=Object(c.a)(t,2),n=function(e,t){return new Date(e,t,0).getDate()}(a[0],a[1]),o=Array(n).fill(null).map(v(e));return this.setLogs(e,o),o}},{key:"setLogs",value:function(e,t){this.hash[e]=t.map(function(e){return{date:e.date,isHoliday:e.isHoliday,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}});var a={};Object.entries(this.hash).forEach(function(e){var t=Object(c.a)(e,2),n=t[0],o=t[1];a[n]=o.map(function(e){return{date:e.date,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}})}),localStorage.setItem(f,JSON.stringify(a))}}]),e}(),y=a(8),p=a.n(y);a(17);function E(e){return r.a.createElement("textarea",{className:"json-view",value:p()(e.logs).replace(/\t/g,"  "),onChange:function(t){return e.onLogsChange(JSON.parse(t.target.value))}})}a(18);function b(e){return r.a.createElement("footer",null,r.a.createElement("select",{value:e.viewMode,onChange:function(t){return e.handleViewModeChange(t.target.value)}},e.viewModes.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),r.a.createElement("a",{href:"https://github.com/leafriend/working-hours/",target:"_blank",rel:"noopener noreferrer"},"Github"))}a(19);function w(e){return r.a.createElement("header",null,"Working Hours of"," ",r.a.createElement("select",{value:e.yearMonth,onChange:function(t){return e.onYearMonthChange(t.target.value)}},e.yearMonths.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))}var A=a(3);a(20);function O(e){return void 0===e?void 0:function(e){var t="-"===e.charAt(0)?-1:1,a=(t<0?e.substring(1):e).split(":").map(function(e){return parseInt(e,10)}),n=Object(c.a)(a,2),o=n[0],r=n[1];return t*(60*o+r)}(e)}function L(e){return void 0===e?void 0:function(e){var t=e<0?"-":"",a=Math.abs(e),n=Math.floor(a/60),o=a-60*n;return"".concat(t).concat(g(n),":").concat(g(o))}(e)}var k=6,j=0,S=function(){function e(t,a,n){Object(u.a)(this,e),this.log=t,this.accumulation=a,this.isActive=n,this.isSaturday=void 0,this.isSunday=void 0;var o=new Date(t.date).getDay();this.isSunday=o===j,this.isSaturday=o===k}return Object(d.a)(e,[{key:"date",get:function(){return this.log.date}},{key:"isHoliday",get:function(){return this.log.isHoliday}},{key:"leaveType",get:function(){return this.log.leaveType}},{key:"startedAt",get:function(){return O(this.log.startedAt)}},{key:"finishedAt",get:function(){return O(this.log.finishedAt)}},{key:"working",get:function(){var e=this;if(this.leaveType===n.FULL)return 570;if(void 0!==this.startedAt&&void 0!==this.finishedAt){var t=this.finishedAt-this.startedAt;return function(){switch(e.leaveType){case n.HALF:return t>=240?480:240+t;case n.WORK:return t<270?t-0:t<540?t-30:t<810?t-60:t-90}}()}}},{key:"overtime",get:function(){if(void 0!==this.working)return this.working-480}},{key:"overall",get:function(){return void 0===this.working?this.accumulation.overall:this.accumulation.overall+this.working}},{key:"target",get:function(){return this.isHoliday||this.isSaturday||this.isSunday?this.accumulation.target:this.accumulation.target+480}},{key:"balance",get:function(){return void 0===this.overtime?this.accumulation.balance:this.accumulation.balance+this.overtime}}]),e}();a(21);function T(e){var t=e.calculatedLog,a=null===t||t.isHoliday||t.isSunday||t.isSaturday,o=null!==t&&t.leaveType===n.FULL;function i(t){if(null!==e.calculatedLog){var a=Object(s.a)({date:e.calculatedLog.date,isHoliday:e.calculatedLog.isHoliday,leaveType:e.calculatedLog.leaveType,startedAt:L(e.calculatedLog.startedAt),finishedAt:L(e.calculatedLog.finishedAt)},t);e.onLogChange(a)}}var l=t?t.date:"Select a date",c=t?t.leaveType:n.WORK,u=t&&L(t.startedAt)||"",d=t&&L(t.finishedAt)||"";return r.a.createElement("div",{className:"LogEditor"},r.a.createElement("div",{className:"heading"},r.a.createElement("h2",null,l),null!==t&&t.date===M?null:r.a.createElement("a",{href:"#log-".concat(M),onClick:function(t){t.preventDefault(),e.onActivate(M,!0)}},"Today")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Leave Type:",r.a.createElement("select",{disabled:a,value:c,onChange:function(e){return i({leaveType:e.target.value})}},r.a.createElement("option",{value:n.WORK},"Work"),r.a.createElement("option",{value:n.HALF},"Half"),r.a.createElement("option",{value:n.FULL},"Full"))),r.a.createElement("label",null,"Started:",r.a.createElement("input",{disabled:a,readOnly:!a&&o,type:"time",value:u,onChange:function(e){return i({startedAt:e.target.value||void 0})}})),r.a.createElement("label",null,"Finished:",r.a.createElement("input",{disabled:a,readOnly:!a&&(o||!t||void 0===t.startedAt),type:"time",value:d,onChange:function(e){return i({finishedAt:e.target.value||void 0})}}))))}function N(e){return r.a.createElement("tr",{id:"log-".concat(e.log.date),className:[e.log.isHoliday?"holiday":e.log.isSunday?"sunday":e.log.isSaturday?"saturday":"weekday",e.log.date<M?"past":"",e.log.date>M?"future":"",e.log.date===M?"today":"",e.log.isActive?"active":""].join(" ").replace(/ +/g," ").trim(),onClick:function(){return e.onActivate(e.log.date)}},r.a.createElement("td",{className:"date"},new Date(e.log.date).getDate()),r.a.createElement("td",null,e.log.leaveType),r.a.createElement("td",{className:"time"},L(e.log.startedAt)||""),r.a.createElement("td",{className:"time"},L(e.log.finishedAt)||""),r.a.createElement("td",{className:"time"},L(e.log.working)||""),r.a.createElement("td",{className:"time"},L(e.log.overall)),r.a.createElement("td",{className:"time"},L(e.log.target)),r.a.createElement("td",{className:"time"},L(e.log.balance)))}function C(e){return r.a.createElement("table",{className:"monthly-logs"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"date"},"D."),r.a.createElement("th",null,"Leave"),r.a.createElement("th",{className:"time"},"Start"),r.a.createElement("th",{className:"time"},"Fin."),r.a.createElement("th",{className:"time"},"Work"),r.a.createElement("th",{className:"time"},"All"),r.a.createElement("th",{className:"time"},"Target"),r.a.createElement("th",{className:"time"},"Bal."))),r.a.createElement("tbody",null,e.logs.map(function(t){return r.a.createElement(N,{key:t.date,log:t,onActivate:e.onActivate})})))}var M="2019-06-04",W={overall:0,target:0,balance:0};function H(e){var t=W,a=Array(e.length);return e.forEach(function(e,n){var o=new S(e,t,!1);a[n]=o,t=o}),a}function F(e){var t=e.yearMonthLog.yearMonth,a=Object(o.useState)(M.startsWith(t)?Object(A.a)({},t,M):{}),n=Object(c.a)(a,2),i=n[0],l=n[1],u=Object(o.useState)({}),d=Object(c.a)(u,2),g=d[0],h=d[1],f=Object(o.useState)(H(e.yearMonthLog.logs)),v=Object(c.a)(f,2),m=v[0],y=v[1];function p(a){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=a.substring(0,7);l(Object(s.a)({},i,Object(A.a)({},o,a))),a.startsWith(t)||e.onYearMonthChange(o),n&&h(Object(s.a)({},g,Object(A.a)({},o,void 0)))}return Object(o.useEffect)(function(){var a=i[t],n=H(e.yearMonthLog.logs);n.forEach(function(e){return e.isActive=e.date===a}),y(n)},[t,e.yearMonthLog,i]),Object(o.useEffect)(function(){var e=document.getElementById("content-container");if(e)if(void 0===g[t]){var a=document.getElementsByClassName("active");a.length>0?e.scrollTo({top:a.item(0).offsetTop}):e.scrollTo({top:0})}else e.scrollTo({top:g[t]})},[t,m]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"content-container",onScroll:function(e){return a=e.target.scrollTop,void h(Object(s.a)({},g,Object(A.a)({},t,a)));var a}},r.a.createElement(C,{logs:m,onActivate:p})),r.a.createElement("div",null,r.a.createElement(T,{calculatedLog:m.find(function(e){return e.isActive})||null,onLogChange:function(t){m.forEach(function(e){e.date===t.date&&(e.log=t)}),y(m);var a=m.map(function(e){return e.log});e.onLogsChange(a)},onActivate:p})))}var D=new Date,I=new Date(D.getTime()-1e3*D.getTimezoneOffset()*60).toISOString().substring(0,7),R=function(){for(var e=[],t=I,a="2019-05";a<=t;){e.push(a);var n=parseInt(a.substring(0,4)),o=parseInt(a.substring(5,7))+1;o>12&&(n++,o=1),a="".concat(n,"-").concat(g(o))}return e}(),U="Table",K="Json",J=new m;var B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Y(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(r.a.createElement(function(){var e=Object(o.useState)(I),t=Object(c.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)(J.getLogs(a)),l=Object(c.a)(i,2),s=l[0],u=l[1],d=Object(o.useState)(U),g=Object(c.a)(d,2),h=g[0],f=g[1];function v(e){n(e),u(J.getLogs(e))}function m(e){u(e),J.setLogs(I,e)}return r.a.createElement("div",{className:"App"},r.a.createElement(w,{yearMonth:a,yearMonths:R,onYearMonthChange:v}),r.a.createElement("article",null,function(){switch(h){case U:return r.a.createElement(F,{yearMonthLog:{yearMonth:a,logs:s},onLogsChange:m,onYearMonthChange:v});case K:return r.a.createElement(E,{logs:s,onLogsChange:m});default:return null}}()),r.a.createElement(b,{viewMode:h,viewModes:[U,K],handleViewModeChange:function(e){return f(e)}}))},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/working-hours",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/working-hours","/service-worker.js");B?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Y(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Y(t,e)})}}()}],[[9,1,2]]]);
//# sourceMappingURL=main.0f22a3cf.chunk.js.map