(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n(19)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),i=n(6),c=n.n(i),l=(n(13),n(1)),s=(n(14),n(15),n(4)),u=n(2),h=n(3);function d(e){return e<10?"0".concat(e):e.toString()}function f(e){var t="-"===e.charAt(0)?-1:1,n=(t<0?e.substring(1):e).split(":").map(function(e){return parseInt(e,10)}),a=Object(l.a)(n,2);return t*(60*a[0]+a[1])}function g(e){var t=e<0?"-":"",n=Math.abs(e),a=Math.floor(n/60),r=n-60*a;return"".concat(t).concat(d(a),":").concat(d(r))}!function(e){e.WORK="WORK",e.HALF="HALF",e.FULL="FULL"}(a||(a={}));var v=function(){function e(t,n){Object(u.a)(this,e),this.balanceHolder=n,this.date=void 0,this.leaveType=void 0,this.startedAt=void 0,this.finishedAt=void 0,this.date=t.date,this.leaveType=t.leaveType,this.startedAt=t.startedAt,this.finishedAt=t.finishedAt}return Object(h.a)(e,[{key:"working",get:function(){var e=this;if(this.leaveType===a.FULL)return g(570);if(void 0!==this.startedAt&&void 0!==this.finishedAt){var t=f(this.startedAt),n=f(this.finishedAt)-t;return g(function(){switch(e.leaveType){case a.HALF:return n>=240?480:240+n;case a.WORK:return n<270?n-0:n<540?n-30:n<810?n-60:n-90}}())}}},{key:"overtime",get:function(){var e=this.working;if(void 0!==e){var t=this.leaveType===a.HALF?4:8;return g(f(e)-60*t)}}},{key:"balance",get:function(){var e=this.overtime;return void 0===e?this.balanceHolder.balance:g(f(this.balanceHolder.balance)+f(e))}}]),e}();function m(e){if(null===e)return null;var t=e.date,n=e.leaveType,r=e.startedAt,o=e.finishedAt;return n===a.WORK&&void 0===r&&void 0===o?null:{date:t,leaveType:n,startedAt:r,finishedAt:o}}var p=function(e){var t=e.log,n=new Date(t.date),r=n.getDay(),i=e.holidays.indexOf(t.date)>=0,c=0===r,l=6===r,u=new Date,h="".concat(u.getFullYear(),"-").concat(d(u.getMonth()+1),"-").concat(d(u.getDate()))===t.date,f=i||c||l,g=t.leaveType===a.FULL;function v(n){var a=Object(s.a)({},t,n);e.onLogChange(a)}return o.a.createElement("tr",{className:[i?"holiday":c?"sunday":l?"saturday":"",h?"today":""].join(" ").replace(/ +/g," ").trim()},o.a.createElement("td",{className:"date"},n.getDate()),o.a.createElement("td",null,o.a.createElement("select",{disabled:f,value:t.leaveType,onChange:function(e){return v({leaveType:e.target.value})}},o.a.createElement("option",{value:a.WORK},"Work"),o.a.createElement("option",{value:a.HALF},"Half"),o.a.createElement("option",{value:a.FULL},"Full"))),o.a.createElement("td",{className:"time"},o.a.createElement("input",{disabled:f,readOnly:!f&&g,type:"time",value:t.startedAt||"",onChange:function(e){return v({startedAt:e.target.value||void 0})}})),o.a.createElement("td",{className:"time"},o.a.createElement("input",{disabled:f,readOnly:!f&&(g||""===t.startedAt),type:"time",value:t.finishedAt||"",onChange:function(e){return v({finishedAt:e.target.value||void 0})}})),o.a.createElement("td",{className:"time"},t.working||"--:--"),o.a.createElement("td",{className:"time"},t.balance))},y=function(e){return o.a.createElement("table",{className:"monthly-logs"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"date"},"D."),o.a.createElement("th",null,"Leave"),o.a.createElement("th",{className:"time"},"Started"),o.a.createElement("th",{className:"time"},"Finished"),o.a.createElement("th",{className:"time"},"Work"),o.a.createElement("th",{className:"time"},"Bal."))),o.a.createElement("tbody",null,e.logs.map(function(t){return o.a.createElement(p,{key:t.date,holidays:e.holidays,log:t,onLogChange:function(t){return e.onLogsChange(t)}})})))};y.toString=function(){return"MonthlyLog"};n(16);var w=function(e){return o.a.createElement("header",null,"Working Hours of ",e.yearMonth)},b=(n(17),function(e){var t=e.logs.map(m);return o.a.createElement("textarea",{className:"json-view",value:JSON.stringify(t),onChange:function(t){return e.onLogsChange(JSON.parse(t.target.value))}})});b.toString=function(){return"JsonView"};n(18);var E=y.toString(),A=b.toString(),L=function(e){return o.a.createElement("footer",null,o.a.createElement("select",{value:e.viewMode,onChange:function(t){return e.handleViewModeChange(t.target.value)}},o.a.createElement("option",{value:E},"Table"),o.a.createElement("option",{value:A},"Text")),"|",o.a.createElement("a",{href:"https://github.com/leafriend/working-hours/",target:"_blank",rel:"noopener noreferrer"},"Github"))},O="logsSet",S=function(){function e(){var t=this;Object(u.a)(this,e),this.hash={};var n=localStorage.getItem(O);null===n?localStorage.setItem(O,"{}"):this.hash=JSON.parse(n),Object.entries(this.hash).forEach(function(e){var n=Object(l.a)(e,2),a=n[0],r=n[1];t.hash[a]=r.map(function(e,t){return e&&!e.date?Object(s.a)({date:"".concat(a,"-").concat(d(t+1))},e):e})})}return Object(h.a)(e,[{key:"getLogSources",value:function(e){if(e in this.hash)return this.hash[e];var t=e.split("-").map(function(e){return parseInt(e)}),n=Object(l.a)(t,2),a=function(e,t){return new Date(e,t,0).getDate()}(n[0],n[1]),r=Array(a).fill(null);return this.setLogSources(e,r),r}},{key:"setLogSources",value:function(e,t){this.hash[e]=t.map(m),localStorage.setItem(O,JSON.stringify(this.hash))}}]),e}(),k="2019-05",N=["2019-05-01","2019-05-06"],j=y.toString(),C=b.toString(),T=new S;function W(e,t){var n={balance:"00:00"},r=Array(t.length);return t.forEach(function(t,o){var i=t||{date:"".concat(e,"-").concat(d(o+1)),leaveType:a.WORK},c=new v(i,n);r[o]=c,n=c}),r}var F=function(){var e=T.getLogSources(k),t=W(k,e),n=Object(r.useState)(t),a=Object(l.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(j),u=Object(l.a)(s,2),h=u[0],d=u[1];function f(e){var t=parseInt(e.date.substring(8),10),n=i.map(m).map(function(n,a){return null===n?a+1===t?e:n:n.date===e.date?e:n}),a=W(k,n);c(a),T.setLogSources(k,a)}return o.a.createElement("div",{className:"App"},o.a.createElement(w,{yearMonth:k}),o.a.createElement("article",null,function(){switch(h){case j:return o.a.createElement(y,{yearMonth:k,holidays:N,logs:i,onLogsChange:f});case C:return o.a.createElement(b,{logs:i,onLogsChange:function(e){var t=W(k,e);c(t),T.setLogSources(k,t)}});default:return null}}()),o.a.createElement(L,{viewMode:h,handleViewModeChange:function(e){return d(e)}}))},M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function H(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(o.a.createElement(F,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/working-hours",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/working-hours","/service-worker.js");M?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):H(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):H(t,e)})}}()}],[[7,1,2]]]);
//# sourceMappingURL=main.d909cdc3.chunk.js.map