(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports=n(21)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),i=n(6),l=n.n(i),c=(n(14),n(1)),s=(n(15),n(4)),u=n(2),d=n(3);function h(e){return e<10?"0".concat(e):e.toString()}!function(e){e.WORK="WORK",e.HALF="HALF",e.FULL="FULL"}(a||(a={}));var g=["2019-05-01","2019-05-06","2019-06-06"],f="logsSet";function m(e){return function(t,n){return null===t?function(e,t){var n="".concat(e,"-").concat(h(t));return{date:n,isHoliday:g.includes(n),leaveType:a.WORK}}(e,n+1):t}}var v=function(){function e(){var t=this;Object(u.a)(this,e),this.hash={};var n=localStorage.getItem(f);if(null===n)localStorage.setItem(f,"{}");else{var r=JSON.parse(n);Object.entries(r).forEach(function(e){var n=Object(c.a)(e,2),r=n[0],o=n[1];t.hash[r]=o.map(function(e,t){if(null===e){var n="".concat(r,"-").concat(h(t+1));return{date:n,isHoliday:g.includes(n),leaveType:a.WORK}}return Object(s.a)({},e,{isHoliday:g.includes(e.date)})})})}}return Object(d.a)(e,[{key:"getLogs",value:function(e){if(e in this.hash)return this.hash[e].map(m(e));var t=e.split("-").map(function(e){return parseInt(e)}),n=Object(c.a)(t,2),a=function(e,t){return new Date(e,t,0).getDate()}(n[0],n[1]),r=Array(a).fill(null).map(m(e));return this.setLogs(e,r),r}},{key:"setLogs",value:function(e,t){this.hash[e]=t.map(function(e){return{date:e.date,isHoliday:e.isHoliday,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}});var n={};Object.entries(this.hash).forEach(function(e){var t=Object(c.a)(e,2),a=t[0],r=t[1];n[a]=r.map(function(e){return{date:e.date,leaveType:e.leaveType,startedAt:e.startedAt,finishedAt:e.finishedAt}})}),localStorage.setItem(f,JSON.stringify(n))}}]),e}(),y=n(7),p=n.n(y);n(16);function E(e){return o.a.createElement("textarea",{className:"json-view",value:p()(e.logs).replace(/\t/g,"  "),onChange:function(t){return e.onLogsChange(JSON.parse(t.target.value))}})}n(17);function b(e){return o.a.createElement("footer",null,o.a.createElement("select",{value:e.viewMode,onChange:function(t){return e.handleViewModeChange(t.target.value)}},e.viewModes.map(function(e){return o.a.createElement("option",{key:e,value:e},e)})),o.a.createElement("a",{href:"https://github.com/leafriend/working-hours/",target:"_blank",rel:"noopener noreferrer"},"Github"))}n(18);function w(e){return o.a.createElement("header",null,"Working Hours of"," ",o.a.createElement("select",{value:e.yearMonth,onChange:function(t){return e.onYearMonthChange(t.target.value)}},e.yearMonths.map(function(e){return o.a.createElement("option",{key:e,value:e},e)})))}n(19);function A(e){return void 0===e?void 0:function(e){var t="-"===e.charAt(0)?-1:1,n=(t<0?e.substring(1):e).split(":").map(function(e){return parseInt(e,10)}),a=Object(c.a)(n,2),r=a[0],o=a[1];return t*(60*r+o)}(e)}function k(e){return void 0===e?void 0:function(e){var t=e<0?"-":"",n=Math.abs(e),a=Math.floor(n/60),r=n-60*a;return"".concat(t).concat(h(a),":").concat(h(r))}(e)}var L=6,O=0,S=function(){function e(t,n,a){Object(u.a)(this,e),this.log=t,this.accumulation=n,this.isActive=a,this.isSaturday=void 0,this.isSunday=void 0;var r=new Date(t.date).getDay();this.isSunday=r===O,this.isSaturday=r===L}return Object(d.a)(e,[{key:"date",get:function(){return this.log.date}},{key:"isHoliday",get:function(){return this.log.isHoliday}},{key:"leaveType",get:function(){return this.log.leaveType}},{key:"startedAt",get:function(){return A(this.log.startedAt)}},{key:"finishedAt",get:function(){return A(this.log.finishedAt)}},{key:"working",get:function(){var e=this;if(this.leaveType===a.FULL)return 570;if(void 0!==this.startedAt&&void 0!==this.finishedAt){var t=this.finishedAt-this.startedAt;return function(){switch(e.leaveType){case a.HALF:return t>=240?480:240+t;case a.WORK:return t<270?t-0:t<540?t-30:t<810?t-60:t-90}}()}}},{key:"overtime",get:function(){if(void 0!==this.working)return this.working-480}},{key:"overall",get:function(){return void 0===this.working?this.accumulation.overall:this.accumulation.overall+this.working}},{key:"target",get:function(){return this.isHoliday||this.isSaturday||this.isSunday?this.accumulation.target:this.accumulation.target+480}},{key:"balance",get:function(){return void 0===this.overtime?this.accumulation.balance:this.accumulation.balance+this.overtime}}]),e}();n(20);function j(e){var t=e.calculatedLog,n=null===t||t.isHoliday||t.isSunday||t.isSaturday,r=null!==t&&t.leaveType===a.FULL;function i(t){if(null!==e.calculatedLog){var n=Object(s.a)({date:e.calculatedLog.date,isHoliday:e.calculatedLog.isHoliday,leaveType:e.calculatedLog.leaveType,startedAt:k(e.calculatedLog.startedAt),finishedAt:k(e.calculatedLog.finishedAt)},t);e.onLogChange(n)}}var l=t?t.date:"Select a date",c=t?t.leaveType:a.WORK,u=t&&k(t.startedAt)||"",d=t&&k(t.finishedAt)||"";return o.a.createElement("div",{className:"LogEditor"},o.a.createElement("h2",null,l),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Leave Type:",o.a.createElement("select",{disabled:n,value:c,onChange:function(e){return i({leaveType:e.target.value})}},o.a.createElement("option",{value:a.WORK},"Work"),o.a.createElement("option",{value:a.HALF},"Half"),o.a.createElement("option",{value:a.FULL},"Full"))),o.a.createElement("label",null,"Started:",o.a.createElement("input",{disabled:n,readOnly:!n&&r,type:"time",value:u,onChange:function(e){return i({startedAt:e.target.value||void 0})}})),o.a.createElement("label",null,"Finished:",o.a.createElement("input",{disabled:n,readOnly:!n&&(r||!t||void 0===t.startedAt),type:"time",value:d,onChange:function(e){return i({finishedAt:e.target.value||void 0})}}))))}function N(e){return o.a.createElement("tr",{className:[e.log.isHoliday?"holiday":e.log.isSunday?"sunday":e.log.isSaturday?"saturday":"",e.log.isActive?"active":""].join(" ").replace(/ +/g," ").trim(),onClick:function(){return e.onActivate(e.log.date)}},o.a.createElement("td",{className:"date"},new Date(e.log.date).getDate()),o.a.createElement("td",null,e.log.leaveType),o.a.createElement("td",{className:"time"},k(e.log.startedAt)||""),o.a.createElement("td",{className:"time"},k(e.log.finishedAt)||""),o.a.createElement("td",{className:"time"},k(e.log.working)||""),o.a.createElement("td",{className:"time"},k(e.log.overall)),o.a.createElement("td",{className:"time"},k(e.log.target)),o.a.createElement("td",{className:"time"},k(e.log.balance)))}function T(e){return o.a.createElement("table",{className:"monthly-logs"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"date"},"D."),o.a.createElement("th",null,"Leave"),o.a.createElement("th",{className:"time"},"Start"),o.a.createElement("th",{className:"time"},"Fin."),o.a.createElement("th",{className:"time"},"Work"),o.a.createElement("th",{className:"time"},"All"),o.a.createElement("th",{className:"time"},"Target"),o.a.createElement("th",{className:"time"},"Bal."))),o.a.createElement("tbody",null,e.logs.map(function(t){return o.a.createElement(N,{key:t.date,log:t,onActivate:e.onActivate})})))}var C=new Date,H="".concat(C.getFullYear(),"-").concat(h(C.getMonth()+1),"-").concat(h(C.getDate())),W={overall:0,target:0,balance:0};function M(e){var t=Object(r.useState)(null),n=Object(c.a)(t,2),a=n[0],i=n[1],l=Object(r.useState)([]),s=Object(c.a)(l,2),u=s[0],d=s[1];return Object(r.useEffect)(function(){var t=a?a.date:H,n=function(e){var t=W,n=Array(e.length);return e.forEach(function(e,a){var r=new S(e,t,!1);n[a]=r,t=r}),n}(e.logs),r=n.filter(function(e){return e.isActive=e.date===t});r.length>0?i(r[0]):i(null),d(n)},[e.logs]),Object(r.useEffect)(function(){if(u.length>0){var e=document.getElementById("content-container"),t=document.getElementsByClassName("active");e&&(t.length>0?e.scrollTo({top:t.item(0).offsetTop}):e.scrollTo({top:0}))}},[u]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"content-container"},o.a.createElement(T,{logs:u,onActivate:function(e){u.forEach(function(t){t.isActive=t.date===e,t.date===e&&i(t)}),d(u)}})),o.a.createElement("div",null,o.a.createElement(j,{calculatedLog:a,onLogChange:function(t){u.forEach(function(e){e.date===t.date&&(e.log=t)}),d(u);var n=u.map(function(e){return e.log});e.onLogsChange(n)}})))}var F="2019-05",R=["2019-05","2019-06"],D=M.name,U=E.name,I=new v;var K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(o.a.createElement(function(){var e=Object(r.useState)(F),t=Object(c.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(I.getLogs(n)),l=Object(c.a)(i,2),s=l[0],u=l[1],d=Object(r.useState)(D),h=Object(c.a)(d,2),g=h[0],f=h[1];function m(e){u(e),I.setLogs(F,e)}return o.a.createElement("div",{className:"App"},o.a.createElement(w,{yearMonth:n,yearMonths:R,onYearMonthChange:function(e){a(e),u(I.getLogs(e))}}),o.a.createElement("article",null,function(){switch(g){case D:return o.a.createElement(M,{logs:s,onLogsChange:m});case U:return o.a.createElement(E,{logs:s,onLogsChange:m});default:return null}}()),o.a.createElement(b,{viewMode:g,viewModes:[D,U],handleViewModeChange:function(e){return f(e)}}))},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/working-hours",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/working-hours","/service-worker.js");K?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):B(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):B(t,e)})}}()}],[[8,1,2]]]);
//# sourceMappingURL=main.0bda904a.chunk.js.map